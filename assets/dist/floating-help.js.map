{
  "version": 3,
  "sources": ["../js/floating-help.js"],
  "sourcesContent": ["/**\r\n * Floating Help Menu\r\n *\r\n * Frontend behavior for the floating help button/menu and modals.\r\n *\r\n * @package Humata_Chatbot\r\n * @since 1.0.0\r\n */\r\n\r\n(function() {\r\n    'use strict';\r\n\r\n    const root = document.getElementById('humata-floating-help');\r\n    if (!root) {\r\n        return;\r\n    }\r\n\r\n    const wrapper = root.querySelector('.humata-floating-help__wrapper');\r\n    const button = root.querySelector('.humata-floating-help__button');\r\n    const panel = root.querySelector('.humata-floating-help__panel');\r\n\r\n    function isTouchMode() {\r\n        try {\r\n            return !!(window.matchMedia && window.matchMedia('(hover: none), (pointer: coarse)').matches);\r\n        } catch (e) {\r\n            return ('ontouchstart' in window);\r\n        }\r\n    }\r\n\r\n    let touchMode = isTouchMode();\r\n    let lastFocused = null;\r\n\r\n    function setMenuExpanded(expanded) {\r\n        if (!button) return;\r\n        button.setAttribute('aria-expanded', expanded ? 'true' : 'false');\r\n        if (panel) {\r\n            panel.setAttribute('aria-hidden', expanded ? 'false' : 'true');\r\n        }\r\n    }\r\n\r\n    function openMenu() {\r\n        if (!wrapper) return;\r\n        wrapper.classList.add('is-open');\r\n        setMenuExpanded(true);\r\n    }\r\n\r\n    function closeMenu() {\r\n        if (!wrapper) return;\r\n        wrapper.classList.remove('is-open');\r\n        setMenuExpanded(false);\r\n    }\r\n\r\n    function toggleMenu() {\r\n        if (!wrapper) return;\r\n        if (wrapper.classList.contains('is-open')) {\r\n            closeMenu();\r\n        } else {\r\n            openMenu();\r\n        }\r\n    }\r\n\r\n    function getModal(modalId) {\r\n        return document.getElementById('humata-help-modal-' + modalId);\r\n    }\r\n\r\n    function openModal(modalId, triggerEl) {\r\n        const modal = getModal(modalId);\r\n        if (!modal) return;\r\n\r\n        lastFocused = triggerEl || document.activeElement;\r\n\r\n        modal.hidden = false;\r\n        modal.classList.add('is-open');\r\n        modal.setAttribute('aria-hidden', 'false');\r\n\r\n        document.documentElement.classList.add('humata-help-modal-open');\r\n        document.body.classList.add('humata-help-modal-open');\r\n\r\n        const closeBtn = modal.querySelector('.humata-help-modal__close');\r\n        if (closeBtn) {\r\n            try {\r\n                closeBtn.focus({ preventScroll: true });\r\n            } catch (e) {\r\n                closeBtn.focus();\r\n            }\r\n        }\r\n    }\r\n\r\n    function closeModal(modal) {\r\n        if (!modal) return;\r\n\r\n        modal.classList.remove('is-open');\r\n        modal.setAttribute('aria-hidden', 'true');\r\n        modal.hidden = true;\r\n\r\n        document.documentElement.classList.remove('humata-help-modal-open');\r\n        document.body.classList.remove('humata-help-modal-open');\r\n\r\n        if (lastFocused && typeof lastFocused.focus === 'function') {\r\n            try {\r\n                lastFocused.focus({ preventScroll: true });\r\n            } catch (e) {\r\n                lastFocused.focus();\r\n            }\r\n        }\r\n        lastFocused = null;\r\n    }\r\n\r\n    function closeAnyModal() {\r\n        const open = document.querySelector('.humata-help-modal.is-open');\r\n        if (open) {\r\n            closeModal(open);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function initTouchMenuBehavior() {\r\n        if (!button || !wrapper) return;\r\n\r\n        button.addEventListener('click', function(e) {\r\n            if (!touchMode) {\r\n                return;\r\n            }\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            toggleMenu();\r\n        });\r\n\r\n        // Close menu on outside click (touch mode only).\r\n        document.addEventListener('click', function(e) {\r\n            if (!touchMode) {\r\n                return;\r\n            }\r\n            if (!wrapper.contains(e.target)) {\r\n                closeMenu();\r\n            }\r\n        }, true);\r\n    }\r\n\r\n    function initModalBehavior() {\r\n        // Open modal from menu triggers.\r\n        root.addEventListener('click', function(e) {\r\n            const trigger = e.target.closest('[data-humata-help-open-modal]');\r\n            if (!trigger) {\r\n                return;\r\n            }\r\n            e.preventDefault();\r\n\r\n            const modalId = String(trigger.getAttribute('data-humata-help-open-modal') || '').trim();\r\n            if (!modalId) {\r\n                return;\r\n            }\r\n\r\n            if (touchMode) {\r\n                closeMenu();\r\n            }\r\n\r\n            openModal(modalId, trigger);\r\n        });\r\n\r\n        // Close modal on overlay click or close button.\r\n        document.addEventListener('click', function(e) {\r\n            const closeTarget = e.target.closest('[data-humata-help-close-modal]');\r\n            if (!closeTarget) {\r\n                return;\r\n            }\r\n            const modal = closeTarget.closest('.humata-help-modal');\r\n            if (!modal) {\r\n                return;\r\n            }\r\n            e.preventDefault();\r\n            closeModal(modal);\r\n        });\r\n\r\n        // ESC closes modal (preferred) or the touch menu if open.\r\n        document.addEventListener('keydown', function(e) {\r\n            if (e.key !== 'Escape') {\r\n                return;\r\n            }\r\n\r\n            if (closeAnyModal()) {\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n\r\n            if (touchMode && wrapper && wrapper.classList.contains('is-open')) {\r\n                closeMenu();\r\n            }\r\n        });\r\n    }\r\n\r\n    // Keep touchMode fresh on resize/orientation changes.\r\n    window.addEventListener('resize', function() {\r\n        const nowTouch = isTouchMode();\r\n        if (nowTouch !== touchMode) {\r\n            touchMode = nowTouch;\r\n            // Ensure we don't leave the menu stuck open if the device mode changes.\r\n            closeMenu();\r\n        }\r\n    });\r\n\r\n    // Init aria state\r\n    setMenuExpanded(false);\r\n\r\n    initTouchMenuBehavior();\r\n    initModalBehavior();\r\n})();\r\n\r\n\r\n"],
  "mappings": "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",
  "names": ["root", "wrapper", "button", "panel", "isTouchMode", "touchMode", "lastFocused", "setMenuExpanded", "expanded", "openMenu", "closeMenu", "toggleMenu", "getModal", "modalId", "openModal", "triggerEl", "modal", "closeBtn", "e", "closeModal", "closeAnyModal", "open", "initTouchMenuBehavior", "initModalBehavior", "trigger", "closeTarget", "nowTouch"]
}
