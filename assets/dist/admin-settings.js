(()=>{(function(t){"use strict";t(function(){var _=window.humataAdminConfig||{},L=String(_.nonce||"");_.documentTitles&&typeof _.documentTitles=="object"?window.humataDocumentTitles=_.documentTitles:(!window.humataDocumentTitles||typeof window.humataDocumentTitles!="object")&&(window.humataDocumentTitles={});var A=String(_.ajaxUrl||window.ajaxurl||"");(function(){var m=window.humataDocumentTitles||{},I=_.i18n&&typeof _.i18n.titleNotFetchedText=="string"?_.i18n.titleNotFetchedText:"(title not fetched)",f=100,d=0;function k(a){var n=(a||"").match(/[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}/ig)||[],o={},i=[];return t.each(n,function(l,c){c=c.toLowerCase(),o[c]||(o[c]=!0,i.push(c))}),i}function g(){return t("#humata-document-ids-tokens .humata-token").map(function(){return(t(this).attr("data-id")||"").toLowerCase()}).get()}function w(a){return a=(a||"").toLowerCase(),m[a]?m[a]:a}function C(){var a=t("#humata-document-ids-tokens"),n=a.children(".humata-token").get();n.sort(function(o,i){var l=(t(o).attr("data-id")||"").toLowerCase(),c=(t(i).attr("data-id")||"").toLowerCase(),p=t.trim(w(l)||l).toLowerCase(),u=t.trim(w(c)||c).toLowerCase();return p===u?c.localeCompare(l):u.localeCompare(p)}),t.each(n,function(o,i){a.append(i)})}function D(a){if(a=(a||"").toLowerCase(),!!a&&!t('#humata-document-ids-tokens .humata-token[data-id="'+a+'"]').length){var n=t("<span></span>").addClass("humata-token").attr("data-id",a).attr("title",w(a)),o=t("<span></span>").addClass("humata-token-label").text(w(a)),i=t("<button></button>").attr("type","button").addClass("humata-token-remove").attr("aria-label","Remove").text("\xD7");n.append(o).append(i),t("#humata-document-ids-tokens").append(n)}}function x(){var a=g();t("#humata_document_ids").val(a.join(", ")),t("#humata-document-count").text(a.length)}function P(a){var n=t("#humata-documents-pagination");if(n.length&&(n.empty(),!(!a||a<=f))){var o=Math.max(1,Math.ceil(a/f)),i=d+1,l=d*f+1,c=Math.min((d+1)*f,a),p=t("<button></button>").attr("type","button").addClass("button button-secondary").attr("id","humata-documents-page-prev").text("Previous").prop("disabled",d<=0),u=t("<button></button>").attr("type","button").addClass("button button-secondary").attr("id","humata-documents-page-next").text("Next").prop("disabled",d>=o-1),v=t("<span></span>").addClass("humata-documents-page-info").text("Showing "+l+"\u2013"+c+" of "+a+" (Page "+i+"/"+o+")");n.append(p).append(v).append(u)}}function b(){var a=t("#humata-documents-table-body");if(a.length){var n=g(),o=n.length;if(!o){a.empty(),P(0);return}var i=Math.max(1,Math.ceil(o/f));d>=i&&(d=i-1),d<0&&(d=0);var l=d*f,c=Math.min(l+f,o),p=n.slice(l,c);a.empty(),t.each(p,function(u,v){var T=m[v]?m[v]:I,y=t("<tr></tr>").attr("data-doc-id",v);y.append(t("<td></td>").addClass("humata-doc-title").text(T)),y.append(t("<td></td>").append(t("<code></code>").text(v))),a.append(y)}),P(o)}}function R(a){var n=k(a);return n.length?(t.each(n,function(o,i){D(i)}),C(),x(),b(),!0):!1}function F(){var a=t("#humata_document_ids"),n=t("#humata-document-ids-tokens");if(!(!a.length||!n.length)){var o=k(a.val());n.empty(),t.each(o,function(i,l){D(l)}),C(),x(),b()}}F(),t(document).on("click","#humata-documents-page-prev",function(){d>0&&(d--,b())}),t(document).on("click","#humata-documents-page-next",function(){var a=g().length,n=Math.max(1,Math.ceil(a/f));d<n-1&&(d++,b())}),t(document).on("click","#humata-document-ids-control, #humata-document-ids-tokens",function(a){t(a.target).closest(".humata-token-remove").length||t("#humata_document_ids_input").trigger("focus")}),t(document).on("click",".humata-token-remove",function(){t(this).closest(".humata-token").remove(),x(),b()}),t(document).on("keydown","#humata_document_ids_input",function(a){var n=a.key;if(n===","||n==="Enter"||n==="Tab"){var o=t(this).val(),i=R(o);if(n==="Enter"||n===","){a.preventDefault(),i&&t(this).val("");return}if(n==="Tab"&&i){a.preventDefault(),t(this).val("");return}}if(n==="Backspace"&&t(this).val()===""){var l=t("#humata-document-ids-tokens .humata-token").last();l.length&&(l.remove(),x(),b(),a.preventDefault())}}),t(document).on("paste","#humata_document_ids_input",function(){var a=t(this);setTimeout(function(){var n=R(a.val());n&&a.val("")},0)}),t(document).on("blur","#humata_document_ids_input",function(){var a=t(this).val(),n=R(a);n&&t(this).val("")});function h(a,n){var o=t("#humata-document-ids-io-status");o.length&&(o.removeClass("humata-io-status-success humata-io-status-error humata-io-status-info"),n==="success"?o.addClass("humata-io-status-success"):n==="error"?o.addClass("humata-io-status-error"):n==="info"&&o.addClass("humata-io-status-info"),o.text(a||""))}function M(){var a=g();return!a||!a.length?"":a.join("\\n")}function N(a,n,o){try{var i=o||"text/plain;charset=utf-8",l=new Blob([n||""],{type:i}),c=URL.createObjectURL(l),p=document.createElement("a");p.href=c,p.download=a||"humata-document-ids.txt",document.body.appendChild(p),p.click(),setTimeout(function(){try{document.body.removeChild(p)}catch(u){}try{URL.revokeObjectURL(c)}catch(u){}},0)}catch(u){h("Download failed.","error")}}function e(a){return navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(a):new Promise(function(n,o){try{var i=t("<textarea></textarea>").css({position:"absolute",left:"-9999px",top:"0"}).val(a||"");t("body").append(i),i[0].focus(),i[0].select();var l=!1;try{l=document.execCommand("copy")}catch(c){l=!1}i.remove(),l?n():o(new Error("copy_failed"))}catch(c){o(c)}})}function r(){var a=t('input[name="humata_document_ids_import_mode"]:checked'),n=a.length?String(a.val()||""):"";return n=t.trim(n),n==="replace"?"replace":"merge"}function s(a,n){var o=String(a||""),i=n==="replace"?"replace":"merge",l=g().length,c=k(o);if(!c.length)return h("No valid UUIDs found to import.","error"),!1;var p=l;i==="replace"&&(t("#humata-document-ids-tokens").empty(),d=0,p=0),t.each(c,function(y,S){D(S)}),C(),x(),b();var u=g().length;if(i==="merge"){var v=Math.max(0,u-p),T=Math.max(0,c.length-v);h("Imported "+v+" IDs ("+T+" duplicates ignored). Click Save Settings to persist.","success")}else h("Replaced "+l+" IDs with "+u+" imported IDs. Click Save Settings to persist.","success");return!0}t(document).on("click","#humata-document-ids-export-copy",function(){var a=M(),n=g().length;if(!a){h("No document IDs to export.","error");return}e(a).then(function(){h("Copied "+n+" IDs to clipboard.","success")}).catch(function(){h("Copy failed. Try Download TXT instead.","error")})}),t(document).on("click","#humata-document-ids-export-download",function(){var a=g();if(!a.length){h("No document IDs to export.","error");return}var n=a.join("\\n")+"\\n";N("humata-document-ids.txt",n,"text/plain;charset=utf-8"),h("Downloaded TXT for "+a.length+" IDs.","info")}),t(document).on("click","#humata-document-ids-export-download-json",function(){var a=g();if(!a.length){h("No document IDs to export.","error");return}var n=JSON.stringify({document_ids:a},null,2);N("humata-document-ids.json",n+"\\n","application/json;charset=utf-8"),h("Downloaded JSON for "+a.length+" IDs.","info")}),t(document).on("change","#humata-document-ids-import-file",function(){var a=this,n=a&&a.files&&a.files[0]?a.files[0]:null;if(n){var o=new FileReader;o.onload=function(i){var l=i&&i.target&&i.target.result?String(i.target.result):"";t("#humata-document-ids-import-text").val(l),h("Loaded file. Choose Merge/Replace and click Apply Import.","info")},o.onerror=function(){h("Failed to read file.","error")};try{o.readAsText(n)}catch(i){h("Failed to read file.","error")}}}),t(document).on("click","#humata-document-ids-import-apply",function(){var a=t("#humata-document-ids-import-text").val(),n=r();s(a,n)}),t(document).on("click","#humata-document-ids-clear-all",function(){var a=g().length;if(!a){h("No document IDs to clear.","info");return}window.confirm("Remove all configured Document IDs?")&&(t("#humata-document-ids-tokens").empty(),d=0,x(),b(),h("Cleared all Document IDs. Click Save Settings to persist.","success"))}),t("#humata-test-api").on("click",function(){var a=t(this),n=t("#humata-test-result");a.prop("disabled",!0).text("Testing..."),n.html(""),t.post(A,{action:"humata_test_api",nonce:L},function(o){a.prop("disabled",!1).text("Test API Connection"),o.success?n.html('<span style="color:green;">\u2713 '+o.data.message+"</span>"):n.html('<span style="color:red;">\u2717 '+o.data.message+"</span>")}).fail(function(){a.prop("disabled",!1).text("Test API Connection"),n.html('<span style="color:red;">\u2717 Request failed</span>')})}),t("#humata-clear-cache").on("click",function(){var a=t(this);a.prop("disabled",!0).text("Clearing..."),t.post(A,{action:"humata_clear_cache",nonce:L},function(n){a.prop("disabled",!1).text("Clear Cache"),n.success?(alert("Cache cleared!"),location.reload()):alert("Failed to clear cache.")})}),t("#humata-test-ask").on("click",function(){var a=t(this),n=t("#humata-test-result");a.prop("disabled",!0).text("Testing Ask..."),n.html(""),t.post(A,{action:"humata_test_ask",nonce:L},function(o){a.prop("disabled",!1).text("Test Ask"),o.success?n.html('<span style="color:green;">\u2713 '+o.data.message+"</span>"):n.html('<span style="color:red;">\u2717 '+o.data.message+"</span>")}).fail(function(){a.prop("disabled",!1).text("Test Ask"),n.html('<span style="color:red;">\u2717 Request failed</span>')})}),t("#humata-fetch-titles").on("click",function(){var a=t(this),n=t("#humata-test-result"),o=0,i=5,l=2e3,c=t("#humata_document_ids").val();a.prop("disabled",!0).text("Fetching..."),n.html("");function p(){t.post(A,{action:"humata_fetch_titles",nonce:L,offset:o,limit:i,document_ids:c},function(u){if(!u.success){a.prop("disabled",!1).text("Fetch Titles");var v=u.data&&u.data.message?u.data.message:"Request failed";u.data&&u.data.errorMessage&&(v=v+" ("+u.data.errorMessage+")"),n.html('<span style="color:red;">\u2717 '+v+"</span>");return}u.data&&u.data.titles&&t.each(u.data.titles,function(y,S){if(y=(y||"").toLowerCase(),!(!y||!S)){m[y]=S;var j=t('#humata-document-ids-tokens .humata-token[data-id="'+y+'"]');j.find(".humata-token-label").text(S),j.attr("title",S),t('#humata-documents-table-body tr[data-doc-id="'+y+'"] .humata-doc-title').text(S)}}),C(),x(),b(),o=u.data.nextOffset;var T=u.data.message||"";if(u.data.errors&&u.data.errorMessage&&(T=T+" ("+u.data.errorMessage+")"),n.html('<span style="color:green;">\u2713 '+T+"</span>"),u.data.done){a.prop("disabled",!1).text("Fetch Titles");return}setTimeout(p,l)}).fail(function(){a.prop("disabled",!1).text("Fetch Titles"),n.html('<span style="color:red;">\u2717 Request failed</span>')})}p()})})(),function(){function m(){var f=t('input[name="humata_second_llm_provider"]:checked'),d=f.length?String(f.val()||""):"";return d=t.trim(d),d||(d="none"),d}function I(){var f=m(),d=f==="straico",k=f==="anthropic",g=f!=="none";t("#humata_straico_api_key").closest("tr").toggle(d),t("#humata_straico_model").closest("tr").toggle(d),t("#humata_anthropic_api_key").closest("tr").toggle(k),t("#humata_anthropic_model").closest("tr").toggle(k),t("#humata_anthropic_extended_thinking").closest("tr").toggle(k),t("#humata_straico_system_prompt").closest("tr").toggle(g)}t(document).on("change",'input[name="humata_second_llm_provider"]',I),I()}(),function(){function m(e,r){var s=parseInt(e,10);return isFinite(s)&&s>=0?s:r||0}function I(e){return'<tr class="humata-repeater-row"><td class="humata-repeater-handle-cell"><span class="dashicons dashicons-move humata-repeater-handle" aria-hidden="true"></span><span class="screen-reader-text">Drag to reorder</span></td><td style="width: 28%"><input type="text" class="regular-text" name="humata_floating_help[external_links]['+e+'][label]" value="" placeholder="Label"></td><td><input type="url" class="regular-text" name="humata_floating_help[external_links]['+e+'][url]" value="" placeholder="https://example.com/"></td><td style="width: 90px"><button type="button" class="button link-delete humata-repeater-remove">Remove</button></td></tr>'}function f(e){return'<tr class="humata-repeater-row"><td class="humata-repeater-handle-cell"><span class="dashicons dashicons-move humata-repeater-handle" aria-hidden="true"></span><span class="screen-reader-text">Drag to reorder</span></td><td style="width: 38%"><input type="text" class="regular-text" name="humata_auto_links['+e+'][phrase]" value="" placeholder="Phrase (exact match)"></td><td><input type="url" class="regular-text" name="humata_auto_links['+e+'][url]" value="" placeholder="https://example.com/"></td><td style="width: 90px"><button type="button" class="button link-delete humata-repeater-remove">Remove</button></td></tr>'}function d(e){return'<tr class="humata-repeater-row"><td class="humata-repeater-handle-cell"><span class="dashicons dashicons-move humata-repeater-handle" aria-hidden="true"></span><span class="screen-reader-text">Drag to reorder</span></td><td style="width: 34%"><input type="text" class="regular-text" name="humata_floating_help[faq_items]['+e+'][question]" value="" placeholder="Question"></td><td><textarea class="large-text" rows="3" name="humata_floating_help[faq_items]['+e+'][answer]" placeholder="Answer"></textarea></td><td style="width: 90px"><button type="button" class="button link-delete humata-repeater-remove">Remove</button></td></tr>'}function k(e){if(!(!e||!e.length)){var r=e.find("tbody");if(r.length&&r.sortable&&!r.data("humataSortableInit")){r.sortable({axis:"y",items:"> tr",handle:".humata-repeater-handle",placeholder:"humata-repeater-placeholder",forcePlaceholderSize:!0,tolerance:"pointer"});try{r.disableSelection()}catch(s){}r.data("humataSortableInit",!0)}}}function g(e){if(!(!e||!e.length)){var r=String(e.data("humataRepeater")||""),s=m(e.attr("data-next-index"),e.find("tbody tr").length),a="";if(r==="external_links"?a=I(s):r==="auto_links"?a=f(s):r==="faq_items"&&(a=d(s)),!!a){var n=e.find("tbody");n.length&&(n.append(a),e.attr("data-next-index",String(s+1)),k(e))}}}t(document).on("click",".humata-floating-help-repeater .humata-repeater-add",function(){g(t(this).closest(".humata-floating-help-repeater"))}),t(document).on("click",".humata-floating-help-repeater .humata-repeater-remove",function(){t(this).closest("tr").remove()}),t(".humata-floating-help-repeater").each(function(){k(t(this))}),t(document).on("click",".humata-upload-avatar",function(e){e.preventDefault();var r=t(this).data("target"),s=wp.media({title:"Select Avatar Image",button:{text:"Use this image"},multiple:!1,library:{type:["image/jpeg","image/png"]}});s.on("select",function(){var a=s.state().get("selection").first().toJSON();t("#"+r).val(a.url),t("#"+r+"_preview").html('<img src="'+a.url+'" style="max-width:64px;max-height:64px;border-radius:6px;" />'),t('.humata-remove-avatar[data-target="'+r+'"]').show()}),s.open()}),t(document).on("click",".humata-remove-avatar",function(e){e.preventDefault();var r=t(this).data("target");t("#"+r).val(""),t("#"+r+"_preview").empty(),t(this).hide()});function w(e,r){return'<tr class="humata-intent-link-row"><td><input type="text" class="regular-text" name="humata_intent_links['+e+"][links]["+r+'][title]" value="" placeholder="Shipping Policy"></td><td><input type="url" class="regular-text" name="humata_intent_links['+e+"][links]["+r+'][url]" value="" placeholder="https://example.com/shipping"></td><td><button type="button" class="button link-delete humata-intent-link-remove">Remove</button></td></tr>'}function C(e,r){return'<tr class="humata-intent-accordion-row"><td><input type="text" class="regular-text" name="humata_intent_links['+e+"][accordions]["+r+'][title]" value="" placeholder="e.g., Shipping Restrictions"></td><td><div class="humata-accordion-toolbar"><button type="button" class="button button-small humata-format-bold" title="Bold"><strong>B</strong></button><button type="button" class="button button-small humata-format-italic" title="Italic"><em>I</em></button><button type="button" class="button button-small humata-format-link" title="Insert Link">\u{1F517}</button></div><textarea class="large-text humata-accordion-content-input" rows="3" name="humata_intent_links['+e+"][accordions]["+r+'][content]" placeholder="Content shown when expanded... (supports formatting)" maxlength="1000"></textarea></td><td><button type="button" class="button link-delete humata-intent-accordion-remove">Remove</button></td></tr>'}function D(e){return'<div class="humata-intent-card" data-intent-index="'+e+'"><div class="humata-intent-card-header"><button type="button" class="humata-intent-toggle" aria-expanded="true" aria-label="Toggle intent"><span class="dashicons dashicons-arrow-down-alt2"></span></button><span class="humata-intent-card-title">Intent #'+(e+1)+'</span><button type="button" class="button link-delete humata-intent-remove">Remove Intent</button></div><div class="humata-intent-card-body"><p><label><strong>Intent Name</strong></label><br><input type="text" class="regular-text" name="humata_intent_links['+e+'][intent_name]" value="" placeholder="e.g., shipping_intent"> <span class="description">Internal label (not shown to users).</span></p><p><label><strong>Keywords</strong></label><br><textarea class="large-text" rows="2" name="humata_intent_links['+e+`][keywords]" placeholder="shipping, ship, delivery, deliver, track, package"></textarea> <span class="description">Comma-separated keywords. If any keyword appears in the user's question, the links below are shown.</span></p><div class="humata-intent-links-sub" data-links-next-index="1"><label><strong>Resource Links</strong></label><table class="widefat striped humata-intent-links-table" style="max-width: 800px; margin-top: 6px;"><thead><tr><th>Title</th><th>URL</th><th style="width: 80px;">Actions</th></tr></thead><tbody><tr class="humata-intent-link-row"><td><input type="text" class="regular-text" name="humata_intent_links[`+e+'][links][0][title]" value="" placeholder="Shipping Policy"></td><td><input type="url" class="regular-text" name="humata_intent_links['+e+'][links][0][url]" value="" placeholder="https://example.com/shipping"></td><td><button type="button" class="button link-delete humata-intent-link-remove">Remove</button></td></tr></tbody></table><p style="margin-top: 8px;"><button type="button" class="button button-secondary humata-intent-link-add">Add Link</button></p></div><div class="humata-intent-accordions-sub" data-accordions-next-index="1" style="margin-top: 20px;"><label><strong>Custom Accordions</strong></label><span class="description" style="display: block; margin-bottom: 6px;">FAQ-style collapsible toggles shown in the chat response.</span><table class="widefat striped humata-intent-accordions-table" style="max-width: 800px; margin-top: 6px;"><thead><tr><th style="width: 200px;">Title</th><th>Content</th><th style="width: 80px;">Actions</th></tr></thead><tbody><tr class="humata-intent-accordion-row"><td><input type="text" class="regular-text" name="humata_intent_links['+e+'][accordions][0][title]" value="" placeholder="e.g., Shipping Restrictions"></td><td><div class="humata-accordion-toolbar"><button type="button" class="button button-small humata-format-bold" title="Bold"><strong>B</strong></button><button type="button" class="button button-small humata-format-italic" title="Italic"><em>I</em></button><button type="button" class="button button-small humata-format-link" title="Insert Link">\u{1F517}</button></div><textarea class="large-text humata-accordion-content-input" rows="3" name="humata_intent_links['+e+'][accordions][0][content]" placeholder="Content shown when expanded... (supports formatting)" maxlength="1000"></textarea></td><td><button type="button" class="button link-delete humata-intent-accordion-remove">Remove</button></td></tr></tbody></table><p style="margin-top: 8px;"><button type="button" class="button button-secondary humata-intent-accordion-add">Add Accordion</button></p></div></div></div>'}t(document).on("click",".humata-intent-add",function(){var e=t(this).closest(".humata-intent-links-repeater"),r=e.find(".humata-intent-links-container"),s=m(e.attr("data-next-index"),r.find(".humata-intent-card").length);r.append(D(s)),e.attr("data-next-index",String(s+1))}),t(document).on("click",".humata-intent-remove",function(){t(this).closest(".humata-intent-card").remove()}),t(document).on("click",".humata-intent-link-add",function(){var e=t(this).closest(".humata-intent-links-sub"),r=e.find("tbody"),s=t(this).closest(".humata-intent-card"),a=m(s.attr("data-intent-index"),0),n=m(e.attr("data-links-next-index"),r.find("tr").length);r.append(w(a,n)),e.attr("data-links-next-index",String(n+1))}),t(document).on("click",".humata-intent-link-remove",function(){var e=t(this).closest("tbody");if(t(this).closest("tr").remove(),e.find("tr").length===0){var r=e.closest(".humata-intent-card"),s=e.closest(".humata-intent-links-sub"),a=m(r.attr("data-intent-index"),0);e.append(w(a,0)),s.attr("data-links-next-index","1")}}),t(document).on("click",".humata-intent-accordion-add",function(){var e=t(this).closest(".humata-intent-accordions-sub"),r=e.find("tbody"),s=t(this).closest(".humata-intent-card"),a=m(s.attr("data-intent-index"),0),n=m(e.attr("data-accordions-next-index"),r.find("tr").length);r.find("tr").length>=5||(r.append(C(a,n)),e.attr("data-accordions-next-index",String(n+1)))}),t(document).on("click",".humata-intent-accordion-remove",function(){var e=t(this).closest("tbody");if(t(this).closest("tr").remove(),e.find("tr").length===0){var r=e.closest(".humata-intent-card"),s=e.closest(".humata-intent-accordions-sub"),a=m(r.attr("data-intent-index"),0);e.append(C(a,0)),s.attr("data-accordions-next-index","1")}});function x(e,r,s){var a=e.selectionStart,n=e.selectionEnd,o=e.value,i=o.substring(a,n);i||(i="text");var l=o.substring(0,a)+r+i+s+o.substring(n);e.value=l,e.focus(),e.setSelectionRange(a+r.length,a+r.length+i.length)}t(document).on("click",".humata-format-bold",function(){var e=t(this).closest("td").find("textarea");e.length&&x(e[0],"<strong>","</strong>")}),t(document).on("click",".humata-format-italic",function(){var e=t(this).closest("td").find("textarea");e.length&&x(e[0],"<em>","</em>")}),t(document).on("click",".humata-format-link",function(){var e=t(this).closest("td").find("textarea");if(e.length){var r=prompt("Enter URL:","https://");r&&r!=="https://"&&x(e[0],'<a href="'+r+'" target="_blank">',"</a>")}});function P(){var e=t(".humata-trigger-pages-list");if(!(!e.length||!e.sortable)&&!e.data("humataSortableInit")){e.sortable({axis:"y",items:"> .humata-trigger-page-item",handle:".humata-repeater-handle",placeholder:"humata-repeater-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:function(){b()}});try{e.disableSelection()}catch(r){}e.data("humataSortableInit",!0)}}function b(){t(".humata-trigger-pages-list .humata-trigger-page-item").each(function(r){var s=t(this);s.find('input[name*="humata_trigger_pages"]').each(function(){var a=t(this).attr("name");a=a.replace(/humata_trigger_pages\[\d+\]/,"humata_trigger_pages["+r+"]"),t(this).attr("name",a)}),s.find('textarea[name*="humata_trigger_pages"]').each(function(){var a=t(this).attr("name");a=a.replace(/humata_trigger_pages\[\d+\]/,"humata_trigger_pages["+r+"]"),t(this).attr("name",a)})});var e=t(".humata-trigger-pages-repeater");e.attr("data-next-index",String(t(".humata-trigger-pages-list .humata-trigger-page-item").length))}t(document).on("click",".humata-trigger-pages-repeater .humata-repeater-remove",function(){var e=t(this).closest(".humata-trigger-page-item"),r=e.find(".wp-editor-area").attr("id");r&&typeof tinymce!="undefined"&&tinymce.get(r)&&tinymce.get(r).remove(),e.remove(),b()}),t(document).on("click",".humata-trigger-pages-add",function(){var e=t(".humata-trigger-pages-list .humata-trigger-page-item").last();e.length&&(e[0].scrollIntoView({behavior:"smooth",block:"center"}),e.find('input[type="text"]').first().focus())}),P();var R="humata_intent_collapsed";function F(){try{var e=localStorage.getItem(R);if(e){var r=JSON.parse(e);if(Array.isArray(r))return r}}catch(s){}return[]}function h(e){try{localStorage.setItem(R,JSON.stringify(e))}catch(r){}}function M(e){var r=e.find(".humata-intent-toggle");e.addClass("humata-intent-collapsed"),r.attr("aria-expanded","false"),r.find(".dashicons").removeClass("dashicons-arrow-down-alt2").addClass("dashicons-arrow-right-alt2")}function N(e){var r=e.find(".humata-intent-toggle");e.removeClass("humata-intent-collapsed"),r.attr("aria-expanded","true"),r.find(".dashicons").removeClass("dashicons-arrow-right-alt2").addClass("dashicons-arrow-down-alt2")}(function(){var e=F();e.length&&t(".humata-intent-card").each(function(){var r=m(t(this).attr("data-intent-index"),-1);r>=0&&e.indexOf(r)!==-1&&M(t(this))})})(),t(document).on("click",".humata-intent-toggle",function(){var e=t(this),r=e.closest(".humata-intent-card"),s=e.attr("aria-expanded")==="true",a=m(r.attr("data-intent-index"),-1);s?M(r):N(r);var n=F(),o=n.indexOf(a);s&&o===-1?n.push(a):!s&&o!==-1&&n.splice(o,1),h(n)})}()})})(jQuery);})();
//# sourceMappingURL=admin-settings.js.map
